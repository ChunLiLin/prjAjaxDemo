
@{
    ViewData["Title"] = "Fetch";
}

<h1>Fetch</h1>

<div id="div1"></div>
<img id="img1" />
<ul id="ul1"></ul>

@section Scripts
{
    <script>
     //fetch('@Url.Content("~/api/index")?name=Marco&age=100')
     //    .then(response=>response.text())
     //    .then(data=>console.log(data))

    async function loadText(){
            const response = await fetch('@Url.Content("~/api/index")?name=Marco&age=100');
            const data = await response.text();
            document.querySelector('#div1').innerHTML = data;
    }
    loadText();

    //fetch('@Url.Content("~/api/Cities")')
    //.then(response=>response.json())
    //.then(datas=>{
    //    const cities = datas.map(city=>`<li>${city}</li>`);
    //        document.querySelector('#ul1').innerHTML = cities.join("");
    //})

    async function loadJson(){
            const response = await fetch('@Url.Content("~/api/Cities")');
            const data = await response.json();
            const cities = data.map(city=>`<li>${city}</li>`);
            document.querySelector('#ul1').innerHTML = cities.join("");
    }
    loadJson();

    //fetch('@Url.Content("~/api/GetImageByte/2")')
    //    .then(Response=>Response.blob())
    //    .then(datas=>{
    //        document.querySelector('#img1').src = URL.createObjectURL(datas);
    //    })

    async function loadImage(){
            const response = await fetch('@Url.Content("~/api/GetImageByte/2")');
            const data = await response.blob();
            document.querySelector('#img1').src = URL.createObjectURL(data);
    }
    loadImage();
    </script>    
}